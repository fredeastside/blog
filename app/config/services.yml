parameters:

services:

    _defaults:
        autowire: true
        autoconfigure: true
        public: false

    AppBundle\:
        resource: '../../src/AppBundle/*'
        exclude: '../../src/AppBundle/{Entity,Repository}'

    # repositories
    AppBundle\Domain\Repository\UserRepository:
        factory: ['@doctrine.orm.entity_manager', getRepository]
        arguments:
            - '@command_bus'
            - 'AppBundle:User'

    # listeners
    AppBundle\EventListener\Doctrine\HashPasswordSubscriber:
        tags:
            - { name: doctrine.event_subscriber }

#    AppBundle\Command\Handler\UserLoginHandler:
#        tags:
#            - { name: command_handler, handles: AppBundle\Command\UserLogin }

    AppBundle\EventListener\Doctrine\ReleaseEventsSubscriber
        tags:
            - { name: doctrine.event_subscriber }
