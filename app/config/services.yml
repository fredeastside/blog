parameters:
    upload_dir: '%kernel.root_dir%/../web/upload'

services:

    _defaults:
        autowire: true
        autoconfigure: true
        public: false

    AppBundle\:
        resource: '../../src/AppBundle/*'
        exclude: '../../src/AppBundle/{DataFixtures}'
#        exclude: '../../src/AppBundle/{Entity, Repository}'

    AppBundle\Common\Repository\Implementation\Repository:
        abstract: true

    AppBundle\User\Repository\Implementation\Users:
        parent: AppBundle\Common\Repository\Implementation\Repository

    # listeners
    AppBundle\Common\Doctrine\EventListener\HashPasswordSubscriber:
        tags:
            - { name: doctrine.event_subscriber }

    AppBundle\User\Registration\Handler\UserRegistration:
        public: true
        tags:
            - { name: command_handler, handles: AppBundle\User\Registration\Command\UserRegistration }

    AppBundle\User\Registration\Handler\UserActivation:
        public: true
        tags:
            - { name: command_handler, handles: AppBundle\User\Registration\Command\UserActivation }

    AppBundle\Category\Add\Handler\AddCategory:
        public: true
        tags:
            - { name: command_handler, handles: AppBundle\Category\Add\Command\AddCategory }

    AppBundle\Common\Doctrine\EventListener\DomainEventsSubscriber:
        tags:
            - { name: doctrine.event_subscriber }

    AppBundle\User\EventListener\SendActivationCodeSubscriber:
        tags:
            - { name: kernel.event_subscriber }

#    AppBundle\Common\EventListener\RequestListener:
#        tags:
#            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest }

    AppBundle\Common\Service\Implementation\FileUpload:
        arguments: ['%upload_dir%']
